<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>Calendario.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">avance1proyecto</a> &gt; <a href="index.source.html" class="el_package">com.cenfotec.calidad.avance1proyecto</a> &gt; <span class="el_source">Calendario.java</span></div><h1>Calendario.java</h1><pre class="source lang-java linenums">package com.cenfotec.calidad.avance1proyecto;

<span class="fc" id="L3">public class Calendario {</span>

<span class="fc" id="L5">    private final int ANIO_MINIMO = 1582;</span>
<span class="fc" id="L6">    private final int[] DIAS_POR_MES = new int[]{31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31};</span>

    public boolean esBisiesto(int anio) {
        //Un año bisiesto en el calendario gregoriano debe:
        //ser divisible entre 4 sin decimales
        //Si el año es divisible entre 100 también debe ser divisble entre 400 sin decimales
<span class="fc bfc" id="L12" title="All 6 branches covered.">        return anio % 4 == 0 &amp;&amp; (anio % 100 != 0 || anio % 400 == 0);</span>
    }

    public boolean esFechaValida(int anio, int mes, int dia) {
        //fechas válidas en el calendario gregoriano deben cumplir con el número de meses, 
        // días y años bisiestos correctos
<span class="fc bfc" id="L18" title="All 2 branches covered.">        if (anio &gt;= ANIO_MINIMO) {</span>
<span class="fc bfc" id="L19" title="All 4 branches covered.">            if (mes &gt; 0 &amp;&amp; mes &lt;= 12) {</span>
<span class="fc bfc" id="L20" title="All 4 branches covered.">                int numeroDeDias = mes == 2 &amp;&amp; esBisiesto(anio) ? DIAS_POR_MES[mes - 1] + 1 : DIAS_POR_MES[mes - 1];</span>
<span class="fc bfc" id="L21" title="All 4 branches covered.">                if (dia &gt; 0 &amp;&amp; dia &lt;= numeroDeDias) {</span>
<span class="fc" id="L22">                    return true;</span>
                }
            }
        }
<span class="fc" id="L26">        return false;</span>
    }

    public int[] diaSiguiente(int anio, int mes, int dia) {
<span class="fc" id="L30">        boolean esBisiesto = esBisiesto(anio);</span>
<span class="fc" id="L31">        int diasDelMes = DIAS_POR_MES[mes - 1];</span>
<span class="fc" id="L32">        int sigDia = dia, sigMes = mes, sigAnio = anio;</span>

<span class="fc bfc" id="L34" title="All 4 branches covered.">        if (mes == 2 &amp;&amp; esBisiesto) {</span>
<span class="fc" id="L35">            diasDelMes++;</span>
        }

<span class="fc bfc" id="L38" title="All 2 branches covered.">        if (dia &lt; diasDelMes) {</span>
<span class="fc" id="L39">            sigDia = dia + 1;</span>
<span class="fc" id="L40">            sigMes = mes;</span>
<span class="fc" id="L41">            sigAnio = anio;</span>
        } else {
<span class="fc" id="L43">            sigDia = 1;</span>

<span class="fc bfc" id="L45" title="All 2 branches covered.">            if (mes == 12) {</span>
<span class="fc" id="L46">                sigMes = 1;</span>
<span class="fc" id="L47">                sigAnio = anio + 1;</span>
            } else {
<span class="fc" id="L49">                sigMes = mes + 1;</span>
<span class="fc" id="L50">                sigAnio = anio;</span>
            }

        }
        
        //retorno en formato tupla
<span class="fc" id="L56">        return new int[] {sigAnio, sigMes, sigDia};</span>
    }

    public int diaSemana(int anio, int mes, int dia) {
        //el cálculo del dia de la semana se hace utilizando el método Key Value
        //los valores de meses y siglos están definidos por Key value
<span class="fc" id="L62">        int[] valoresMeses = {1, 4, 4, 0, 2, 5, 0, 3, 6, 1, 4, 6};</span>
<span class="fc" id="L63">        boolean esBisiesto = esBisiesto(anio);</span>
<span class="fc" id="L64">        int valorSiglo = 0;</span>
        int diaSemana;

<span class="fc" id="L67">        int resulKeyValue = ((int) (anio % 100) / 4) + (dia + valoresMeses[mes - 1]);</span>

<span class="fc bfc" id="L69" title="All 8 branches covered.">        if (mes == 1 &amp;&amp; esBisiesto || mes == 2 &amp;&amp; esBisiesto) {</span>
<span class="fc" id="L70">            resulKeyValue -= 1;</span>
        }

<span class="fc" id="L73">        int siglo = Integer.parseInt(Integer.toString(anio).substring(0, 2) + &quot;00&quot;);</span>
<span class="fc" id="L74">        int decadaAnio = Integer.parseInt(Integer.toString(anio).substring(2, 4));</span>

        //el calendario gregoriano se repite cada 400 años por eso es necesario
        //sumar o restar hasta encontrar un valor en este rango
<span class="fc bfc" id="L78" title="All 4 branches covered.">        if (siglo &lt; 1700 || siglo &gt; 2099) {</span>
<span class="fc bfc" id="L79" title="All 4 branches covered.">            while (siglo &lt; 1700 || siglo &gt; 2099) {</span>
<span class="fc bfc" id="L80" title="All 2 branches covered.">                if (siglo &lt; 1700) {</span>
<span class="fc" id="L81">                    siglo += 400;</span>
                } else {
<span class="fc" id="L83">                    siglo -= 400;</span>
                }
            }
        }

<span class="pc bpc" id="L88" title="1 of 5 branches missed.">        switch (siglo) {</span>
            case 1700:
<span class="fc" id="L90">                valorSiglo = 4;</span>
<span class="fc" id="L91">                break;</span>
            case 1800:
<span class="fc" id="L93">                valorSiglo = 2;</span>
<span class="fc" id="L94">                break;</span>
            case 1900:
<span class="fc" id="L96">                valorSiglo = 0;</span>
<span class="fc" id="L97">                break;</span>
            case 2000:
<span class="fc" id="L99">                valorSiglo = 6;</span>
<span class="fc" id="L100">                break;</span>
            default:
                break;
        }

<span class="fc" id="L105">        resulKeyValue += valorSiglo + decadaAnio;</span>
<span class="fc" id="L106">        resulKeyValue = (int) resulKeyValue % 7;</span>
<span class="fc bfc" id="L107" title="All 2 branches covered.">        diaSemana = resulKeyValue == 0 ? 6 : resulKeyValue - 1;</span>

<span class="fc" id="L109">        return diaSemana;</span>

    }
    
    public int[] fechaFutura(int[] fechaInicio, int diasFuturo) {
<span class="fc" id="L114">        boolean esFechaValida = esFechaValida(fechaInicio[0], fechaInicio[1], fechaInicio[2]);</span>
<span class="fc bfc" id="L115" title="All 2 branches covered.">        boolean esDiasFuturoValido = diasFuturo &gt; 0;</span>
<span class="fc bfc" id="L116" title="All 4 branches covered.">        if (esFechaValida &amp;&amp; esDiasFuturoValido) {</span>
<span class="fc" id="L117">            int anioActual = fechaInicio[0];</span>
<span class="fc" id="L118">            int mesActual = fechaInicio[1];</span>
<span class="fc" id="L119">            int diaActual = fechaInicio[2];</span>
<span class="fc" id="L120">            int contador = diasFuturo;</span>
<span class="fc bfc" id="L121" title="All 2 branches covered.">            while(contador &gt; 0) {</span>
<span class="fc" id="L122">                diaActual += 1;</span>
<span class="fc bfc" id="L123" title="All 2 branches covered.">                if (diaActual &gt; DIAS_POR_MES[mesActual - 1]) {</span>
<span class="fc bfc" id="L124" title="All 4 branches covered.">                    if (mesActual != 2 || !esBisiesto(anioActual)) {</span>
<span class="fc" id="L125">                        diaActual = 1;</span>
<span class="fc" id="L126">                        mesActual += 1;</span>
<span class="fc bfc" id="L127" title="All 2 branches covered.">                        if (mesActual &gt; DIAS_POR_MES.length) {</span>
<span class="fc" id="L128">                            mesActual = 1;</span>
<span class="fc" id="L129">                            anioActual += 1;</span>
                        }
                    }
                }
<span class="fc" id="L133">                contador--;</span>
            }
<span class="fc" id="L135">            return new int[] { anioActual, mesActual, diaActual };</span>
        }
<span class="fc" id="L137">        throw new IllegalArgumentException();</span>
    }
    
    public int[] fechaPasada(int[] fechaInicio, int diasPasado) {
<span class="fc" id="L141">        boolean esFechaValida = esFechaValida(fechaInicio[0], fechaInicio[1], fechaInicio[2]);</span>
<span class="fc bfc" id="L142" title="All 2 branches covered.">        boolean esDiasFuturoValido = diasPasado &gt; 0;</span>
<span class="fc bfc" id="L143" title="All 4 branches covered.">        if (esFechaValida &amp;&amp; esDiasFuturoValido) {</span>
<span class="fc" id="L144">            int anioActual = fechaInicio[0];</span>
<span class="fc" id="L145">            int mesActual = fechaInicio[1];</span>
<span class="fc" id="L146">            int diaActual = fechaInicio[2];</span>
<span class="fc" id="L147">            int contador = diasPasado;</span>
<span class="fc bfc" id="L148" title="All 2 branches covered.">            while(contador &gt; 0) {</span>
<span class="fc" id="L149">                diaActual -= 1;</span>
<span class="fc bfc" id="L150" title="All 2 branches covered.">                if (diaActual == 0) {</span>
<span class="fc" id="L151">                    mesActual -= 1;</span>
<span class="fc bfc" id="L152" title="All 2 branches covered.">                    if (mesActual == 0) {</span>
<span class="fc" id="L153">                        mesActual = DIAS_POR_MES.length;</span>
<span class="fc" id="L154">                        anioActual -= 1;</span>
                    }
<span class="fc" id="L156">                    diaActual = DIAS_POR_MES[mesActual - 1];</span>
<span class="fc bfc" id="L157" title="All 4 branches covered.">                    if (mesActual == 2 &amp;&amp; esBisiesto(anioActual)) {</span>
<span class="fc" id="L158">                        diaActual += 1;</span>
                    }
                }
<span class="fc" id="L161">                contador--;</span>
            }
<span class="fc" id="L163">            return new int[] { anioActual, mesActual, diaActual };</span>
        }
<span class="fc" id="L165">        throw new IllegalArgumentException();</span>
    }

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.5.201910111838</span></div></body></html>